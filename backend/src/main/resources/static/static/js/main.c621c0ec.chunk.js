(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{146:function(e,t,s){},165:function(e,t,s){},460:function(e,t,s){"use strict";s.r(t);var i=s(0),n=s.n(i),a=s(22),c=s.n(a),r=(s(146),s(15)),o=s(17),d=s(19),l=s(18),u=s(57),h=s.n(u),p=(s(165),s(166),s(96)),f=s(464),j=s(465),b=s(466),g=s(139),O=s(467),y=s(121),I=s(10),m=function(e){Object(d.a)(s,e);var t=Object(l.a)(s);function s(e){var i;return Object(r.a)(this,s),(i=t.call(this,e)).state={domain:"",corpId:"",authCode:"",userId:"",userName:"",unionId:"",spaceId:"",deptId:"",showType:0,deptList:[],targetDeptList:"",fileId:""},i}return Object(o.a)(s,[{key:"render",value:function(){var e=this,t={unionId:this.state.unionId,spaceId:this.state.spaceId,type:"image"};return""===this.state.userId&&this.login(),Object(I.jsxs)("div",{className:"content",children:[Object(I.jsxs)("div",{className:"header",children:[Object(I.jsx)("img",{src:"https://img.alicdn.com/imgextra/i3/O1CN01Mpftes1gwqxuL0ZQE_!!6000000004207-2-tps-240-240.png",className:"headImg"}),"\u9489\u9489\u6a21\u677f"]}),Object(I.jsxs)("div",{className:"App",children:[0===this.state.showType&&Object(I.jsxs)("div",{children:[Object(I.jsx)("h2",{children:"\u9489\u76d8\u529f\u80fd"}),Object(I.jsx)("p",{children:Object(I.jsx)(p.a,{type:"primary",onClick:function(){return e.createSpace()},children:"\u521b\u5efa\u9489\u76d8\u7a7a\u95f4"})}),Object(I.jsx)("p",{children:Object(I.jsx)(f.a,{action:"/biz/upload",data:t,name:"file",onChange:function(t){return e.uploadFile(t)},children:Object(I.jsx)(p.a,{type:"primary",icon:Object(I.jsx)(O.a,{}),children:"\u4e0a\u4f20\u56fe\u7247\u5230\u9489\u76d8\u7a7a\u95f4"})})}),Object(I.jsx)("p",{children:Object(I.jsx)(p.a,{type:"primary",onClick:function(t){return e.showDept(t,1)},children:"\u6388\u6743\u90e8\u95e8\u8be5\u56fe\u7247\u67e5\u770b/\u53ef\u4e0b\u8f7d\u6743\u9650"})}),Object(I.jsx)("p",{children:Object(I.jsx)(p.a,{type:"primary",onClick:function(){return e.download()},children:"\u4e0b\u8f7d\u9489\u76d8\u7a7a\u95f4\u7684\u56fe\u7247"})})]}),1===this.state.showType&&Object(I.jsxs)("div",{children:[Object(I.jsx)("h2",{children:"\u90e8\u95e8\u5217\u8868"}),console.log(this.state.addDeptToList,"000000"),Object(I.jsx)(j.a.Group,{onChange:function(t){return e.addDeptToList(t)},value:this.state.targetDeptList,children:Object(I.jsx)(b.b,{direction:"vertical",children:this.state.deptList.map((function(e,t){return Object(I.jsx)(j.a,{value:e.deptId,children:e.name},t)}))})}),Object(I.jsx)("br",{}),Object(I.jsx)("br",{}),Object(I.jsx)(p.a,{type:"primary",onClick:function(){return e.addPermissions()},children:"\u4e3a\u9009\u4e2d\u90e8\u95e8\u6dfb\u52a0\u67e5\u770b/\u53ef\u4e0b\u8f7d\u6743\u9650"}),Object(I.jsx)("br",{}),Object(I.jsx)("a",{onClick:function(){return e.setState({showType:0})},children:"\u2190\u8fd4\u56de"})]}),2===this.state.showType&&Object(I.jsxs)("div",{children:[Object(I.jsx)("h2",{children:"\u521b\u5efa\u9489\u76d8\u7a7a\u95f4"}),Object(I.jsx)("input",{type:"text",name:""}),Object(I.jsx)("br",{}),Object(I.jsx)("a",{onClick:function(){return e.setState({showType:0})},children:"\u2190\u8fd4\u56de"})]})]})]})}},{key:"addDeptToList",value:function(e){console.log(e.target.value,"====="),this.setState({targetDeptList:e.target.value})}},{key:"download",value:function(){var e=this.state.fileId,t=this.state.spaceId,s=this.state.unionId;window.open(this.state.domain+"/biz/download?fileId="+e+"&spaceId="+t+"&unionId="+s)}},{key:"showDept",value:function(e,t){var s=this;h.a.post(this.state.domain+"/biz/getDeptList",JSON.stringify(t),{headers:{"Content-Type":"application/json"}}).then((function(e){e.data.success?s.setState({deptList:e.data.data,showType:1}):g.b.error(e.data.errorMsg)})).catch((function(e){alert("showDept err, "+JSON.stringify(e))}))}},{key:"addPermissions",value:function(){var e=this,t=this.state.fileId,s=this.state.spaceId;if(t&&s||g.b.error("\u8bf7\u5148\u4e0a\u4f20\u56fe\u7247/\u521b\u5efa\u7a7a\u95f4"),this.state.targetDeptList){var i={fileId:t,spaceId:s,userId:this.state.userId,unionId:this.state.unionId,deptIds:this.state.targetDeptList};h.a.post(this.state.domain+"/biz/addPermissions",JSON.stringify(i),{headers:{"Content-Type":"application/json"}}).then((function(t){t.data.success?(e.setState({deptList:[],targetDeptList:"",showType:0}),g.b.success("\u6dfb\u52a0\u6743\u9650\u6210\u529f\uff01")):g.b.error(t.data.errorMsg)})).catch((function(e){alert("addPermissions err, "+JSON.stringify(e))}))}else g.b.error("\u8bf7\u5148\u9009\u62e9\u90e8\u95e8")}},{key:"uploadFile",value:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),null!==e.file.response&&void 0!==e.file.response&&!0===e.file.response.success?(this.setState({fileId:e.file.response.data.fileId}),g.b.success("".concat(e.file.name," \u6587\u4ef6\u4e0a\u4f20\u6210\u529f"))):null!==e.file.response&&void 0!==e.file.response&&!1===e.file.response.success&&g.b.error("".concat(e.file.response.errorMsg))}},{key:"chooseFile",value:function(e){var t=e.target.value;this.state({file:t})}},{key:"createSpace",value:function(){var e=this,t={unionId:this.state.unionId,spaceName:"\u4e00\u53f7\u7a7a\u95f4"};h.a.post(this.state.domain+"/biz/createSpace",JSON.stringify(t),{headers:{"Content-Type":"application/json"}}).then((function(t){t.data.success?(e.setState({spaceId:t.data.data.spaceId}),g.b.success("\u521b\u5efa\u9489\u76d8\u7a7a\u95f4\u6210\u529f\uff01")):g.b.error(t.data.errorMsg)})).catch((function(e){alert("createSpace err, "+JSON.stringify(e))}))}},{key:"login",value:function(){var e=this;h.a.get(this.state.domain+"/getCorpId").then((function(t){t.data&&e.loginAction(t.data)})).catch((function(e){alert("corpId err, "+JSON.stringify(e))}))}},{key:"loginAction",value:function(e){var t=this;y.runtime.permission.requestAuthCode({corpId:e,onSuccess:function(e){h.a.get(t.state.domain+"/login?authCode="+e.code).then((function(e){if(e&&e.data.success){var s=e.data.data.userId,i=e.data.data.userName,n=e.data.data.unionId;g.b.success("\u767b\u5f55\u6210\u529f\uff0c\u4f60\u597d"+i),t.setState({userId:s,userName:i,unionId:n})}else alert("login failed ---\x3e"+JSON.stringify(e))})).catch((function(e){alert("httpRequest failed ---\x3e"+JSON.stringify(e))}))},onFail:function(e){alert("requestAuthCode failed ---\x3e"+JSON.stringify(e))}})}}]),s}(n.a.Component),x=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,468)).then((function(t){var s=t.getCLS,i=t.getFID,n=t.getFCP,a=t.getLCP,c=t.getTTFB;s(e),i(e),n(e),a(e),c(e)}))};c.a.render(Object(I.jsx)(n.a.StrictMode,{children:Object(I.jsx)(m,{})}),document.getElementById("root")),x()}},[[460,1,2]]]);
//# sourceMappingURL=main.c621c0ec.chunk.js.map