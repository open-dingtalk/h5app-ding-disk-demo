{"version":3,"sources":["App.js","reportWebVitals.js","index.js"],"names":["App","props","state","domain","corpId","authCode","userId","userName","unionId","spaceId","deptId","showType","deptList","targetDeptList","fileId","data","this","type","login","className","src","onClick","createSpace","action","name","onChange","e","uploadFile","icon","UploadOutlined","showDept","download","console","log","addDeptToList","Group","value","direction","map","item","i","addPermissions","setState","target","window","open","axios","post","JSON","stringify","headers","then","res","success","message","error","errorMsg","catch","alert","deptIds","info","file","status","fileList","response","undefined","spaceName","get","loginAction","_this","dd","permission","requestAuthCode","onSuccess","code","onFail","err","React","Component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.c621c0ec.chunk.js","sourcesContent":["import axios from \"axios\"\nimport React from \"react\"\nimport \"./App.css\"\nimport \"antd/dist/antd.min.css\"\nimport { Button, message, Upload, Checkbox, Radio, Space } from \"antd\"\nimport { UploadOutlined } from \"@ant-design/icons\"\nimport * as dd from \"dingtalk-jsapi\"\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      //内网穿透工具介绍:\n      // https://developers.dingtalk.com/document/resourcedownload/http-intranet-penetration?pnamespace=app\n      domain: \"\",\n      corpId: \"\",\n      authCode: \"\",\n      userId: \"\",\n      userName: \"\",\n      unionId: \"\",\n      spaceId: \"\",\n      deptId: \"\",\n      showType: 0,\n      deptList: [],\n      targetDeptList: \"\",\n      fileId: \"\",\n    }\n  }\n\n  render() {\n    let data = {\n      unionId: this.state.unionId,\n      spaceId: this.state.spaceId,\n      type: \"image\",\n    }\n    if (this.state.userId === \"\") {\n      // 免登操作\n      this.login()\n    }\n    return (\n      <div className=\"content\">\n        <div className=\"header\">\n          <img\n            src=\"https://img.alicdn.com/imgextra/i3/O1CN01Mpftes1gwqxuL0ZQE_!!6000000004207-2-tps-240-240.png\"\n            className=\"headImg\"\n          />\n          钉钉模板\n        </div>\n        <div className=\"App\">\n          {this.state.showType === 0 && (\n            <div>\n              <h2>钉盘功能</h2>\n              <p>\n                <Button type=\"primary\" onClick={() => this.createSpace()}>\n                  创建钉盘空间\n                </Button>\n              </p>\n              <p>\n                <Upload\n                  action=\"/biz/upload\"\n                  data={data}\n                  name=\"file\"\n                  onChange={(e) => this.uploadFile(e)}\n                >\n                  <Button type=\"primary\" icon={<UploadOutlined />}>\n                    上传图片到钉盘空间\n                  </Button>\n                </Upload>\n              </p>\n              <p>\n                <Button type=\"primary\" onClick={(e) => this.showDept(e, 1)}>\n                  授权部门该图片查看/可下载权限\n                </Button>\n              </p>\n              <p>\n                <Button type=\"primary\" onClick={() => this.download()}>\n                  下载钉盘空间的图片\n                </Button>\n              </p>\n            </div>\n          )}\n          {this.state.showType === 1 && (\n            <div>\n              <h2>部门列表</h2>\n              {console.log(this.state.addDeptToList, \"000000\")}\n              <Radio.Group\n                onChange={(e) => this.addDeptToList(e)}\n                value={this.state.targetDeptList}\n              >\n                <Space direction=\"vertical\">\n                  {this.state.deptList.map((item, i) => (\n                    <Radio value={item.deptId} key={i}>\n                      {item.name}\n                      {/* span 标签是做的 部门如果还有下一级时候的处理 */}\n                      {/* {<span onClick={(e) => this.showDept(e, item.deptId)}>⇢</span>} */}\n                    </Radio>\n                  ))}\n                </Space>\n              </Radio.Group>\n              {/* {this.state.deptList.map((item, i) => (\n                <p key={i}>\n                  <checkBox\n                    value={item.deptId}\n                    name={item.name}\n                    onChange={(e) => this.addDeptToList(e)}\n                  >\n                    {item.name}\n                  </checkBox>\n                  <span onClick={(e) => this.showDept(e, item.deptId)}>⇢</span>\n                </p>\n              ))} */}\n              <br />\n              <br />\n              <Button type=\"primary\" onClick={() => this.addPermissions()}>\n                为选中部门添加查看/可下载权限\n              </Button>\n              <br />\n              <a onClick={() => this.setState({ showType: 0 })}>←返回</a>\n            </div>\n          )}\n          {this.state.showType === 2 && (\n            <div>\n              <h2>创建钉盘空间</h2>\n              <input type=\"text\" name={\"\"} />\n              <br />\n              <a onClick={() => this.setState({ showType: 0 })}>←返回</a>\n            </div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  addDeptToList(e) {\n    console.log(e.target.value, \"=====\")\n    this.setState({ targetDeptList: e.target.value })\n    // 以下做的处理是为了方便多选情况\n    // let list = this.state.targetDeptList\n    // let deptId = e.target.value\n    // if (list.indexOf(deptId) === -1) {\n    //   list.push(deptId)\n    //   this.setState({\n    //     targetDeptList: list,\n    //   })\n    // }\n  }\n\n  download() {\n    const fileId = this.state.fileId\n    const spaceId = this.state.spaceId\n    const unionId = this.state.unionId\n    window.open(\n      this.state.domain +\n        \"/biz/download?fileId=\" +\n        fileId +\n        \"&spaceId=\" +\n        spaceId +\n        \"&unionId=\" +\n        unionId\n    )\n  }\n\n  showDept(e, deptId) {\n    axios\n      .post(this.state.domain + \"/biz/getDeptList\", JSON.stringify(deptId), {\n        headers: { \"Content-Type\": \"application/json\" },\n      })\n      .then((res) => {\n        if (res.data.success) {\n          this.setState({\n            deptList: res.data.data,\n            showType: 1,\n          })\n        } else {\n          message.error(res.data.errorMsg)\n        }\n      })\n      .catch((error) => {\n        alert(\"showDept err, \" + JSON.stringify(error))\n      })\n  }\n\n  addPermissions() {\n    const fileId = this.state.fileId\n    const spaceId = this.state.spaceId\n    if (!fileId || !spaceId) {\n      message.error(\"请先上传图片/创建空间\")\n    }\n    if (!this.state.targetDeptList) {\n      message.error(\"请先选择部门\")\n      return\n    }\n    let data = {\n      fileId,\n      spaceId,\n      userId: this.state.userId,\n      unionId: this.state.unionId,\n      deptIds: this.state.targetDeptList,\n    }\n    axios\n      .post(this.state.domain + \"/biz/addPermissions\", JSON.stringify(data), {\n        headers: { \"Content-Type\": \"application/json\" },\n      })\n      .then((res) => {\n        if (res.data.success) {\n          this.setState({\n            deptList: [],\n            targetDeptList: \"\",\n            showType: 0,\n          })\n          message.success(\"添加权限成功！\")\n        } else {\n          message.error(res.data.errorMsg)\n        }\n      })\n      .catch((error) => {\n        alert(\"addPermissions err, \" + JSON.stringify(error))\n      })\n  }\n\n  uploadFile(info) {\n    if (info.file.status !== \"uploading\") {\n      console.log(info.file, info.fileList)\n    }\n    if (\n      info.file.response !== null &&\n      info.file.response !== undefined &&\n      info.file.response.success === true\n    ) {\n      this.setState({ fileId: info.file.response.data.fileId })\n      //   sessionStorage.setItem(\"fileId\", info.file.response.data.fileId)\n      //   console.log(\"fileId: \" + info.file.response.data.fileId)\n      message.success(`${info.file.name} 文件上传成功`)\n    } else if (\n      info.file.response !== null &&\n      info.file.response !== undefined &&\n      info.file.response.success === false\n    ) {\n      message.error(`${info.file.response.errorMsg}`)\n    }\n  }\n\n  chooseFile(e) {\n    let value = e.target.value\n    this.state({\n      file: value,\n    })\n  }\n\n  createSpace() {\n    let data = {\n      unionId: this.state.unionId,\n      spaceName: \"一号空间\",\n    }\n    axios\n      .post(this.state.domain + \"/biz/createSpace\", JSON.stringify(data), {\n        headers: { \"Content-Type\": \"application/json\" },\n      })\n      .then((res) => {\n        if (res.data.success) {\n          this.setState({\n            spaceId: res.data.data.spaceId,\n          })\n          message.success(\"创建钉盘空间成功！\")\n        } else {\n          message.error(res.data.errorMsg)\n        }\n      })\n      .catch((error) => {\n        alert(\"createSpace err, \" + JSON.stringify(error))\n      })\n  }\n\n  //登录-获取corpId\n  login() {\n    axios\n      .get(this.state.domain + \"/getCorpId\")\n      .then((res) => {\n        if (res.data) {\n          this.loginAction(res.data)\n        }\n      })\n      .catch((error) => {\n        alert(\"corpId err, \" + JSON.stringify(error))\n      })\n  }\n\n  //登录操作\n  loginAction(corpId) {\n    let _this = this\n    dd.runtime.permission.requestAuthCode({\n      corpId: corpId, //企业 corpId\n      onSuccess: function (res) {\n        // 调用成功时回调\n        axios\n          .get(_this.state.domain + \"/login?authCode=\" + res.code)\n          .then((res) => {\n            if (res && res.data.success) {\n              let userId = res.data.data.userId\n              let userName = res.data.data.userName\n              let unionId = res.data.data.unionId\n              message.success(\"登录成功，你好\" + userName)\n              _this.setState({\n                userId: userId,\n                userName: userName,\n                unionId: unionId,\n              })\n            } else {\n              alert(\"login failed --->\" + JSON.stringify(res))\n            }\n          })\n          .catch((error) => {\n            alert(\"httpRequest failed --->\" + JSON.stringify(error))\n          })\n      },\n      onFail: function (err) {\n        // 调用失败时回调\n        alert(\"requestAuthCode failed --->\" + JSON.stringify(err))\n      },\n    })\n  }\n}\n\nexport default App\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}